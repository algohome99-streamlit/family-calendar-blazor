@inject IDataService DataService

<div class="leaderboard-section">
    <h2>ğŸ† ç©åˆ†æ’è¡Œæ¦œ</h2>

    <div class="leaderboard">
        @foreach (var member in memberPoints.OrderByDescending(m => m.Value))
        {
            var emoji = member.Key switch
            {
                "å“¥å“¥" => "ğŸ‘¦",
                "å¦¹å¦¹" => "ğŸ‘§",
                "å…¨å®¶" => "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦",
                _ => "ğŸ‘¤"
            };
            var progress = Math.Min(100, (int)((double)member.Value / pointsGoal * 100));

            <div class="leaderboard-item">
                <div class="leaderboard-avatar">@emoji</div>
                <div class="leaderboard-name">@member.Key</div>
                <div class="leaderboard-points">@member.Value åˆ†</div>
                <div class="progress-bar" style="height: 12px;">
                    <div class="progress-fill" style="width: @progress%"></div>
                </div>
                <div style="font-size: 0.875rem; color: #666; margin-top: 0.5rem;">
                    ç›®æ¨™ @pointsGoal åˆ†
                </div>
            </div>
        }
    </div>
</div>

@code {
    private Dictionary<string, int> memberPoints = new()
    {
        { "å“¥å“¥", 0 },
        { "å¦¹å¦¹", 0 },
        { "å…¨å®¶", 0 }
    };
    private int pointsGoal = 50;

    protected override async Task OnInitializedAsync()
    {
        await LoadData();
    }

    private async Task LoadData()
    {
        var settings = await DataService.GetSettingsAsync();
        pointsGoal = settings.PointsGoal;

        var history = await DataService.GetHistoryAsync();

        memberPoints = new Dictionary<string, int>
        {
            { "å“¥å“¥", 0 },
            { "å¦¹å¦¹", 0 },
            { "å…¨å®¶", 0 }
        };

        foreach (var record in history)
        {
            if (memberPoints.ContainsKey(record.Member))
            {
                memberPoints[record.Member] += record.Points;
            }
        }
    }
}
