@inject AuthService AuthService

<div class="login-container">
    <div class="login-box">
        <h2>ğŸ” æ­¡è¿ä¾†åˆ°æˆ‘å€‘çš„ç§˜å¯†åŸºåœ°</h2>
        <input type="password"
               @bind="password"
               @bind:event="oninput"
               @onkeypress="HandleKeyPress"
               placeholder="è«‹è¼¸å…¥å®¶åº­æš—è™Ÿ" />
        <button class="btn btn-primary" @onclick="HandleLogin" disabled="@isLoading">
            @if (isLoading)
            {
                <span>ç™»å…¥ä¸­...</span>
            }
            else
            {
                <span>ç™»å…¥ç™½æ¿</span>
            }
        </button>
        @if (!string.IsNullOrEmpty(errorMessage))
        {
            <p class="error-message">@errorMessage</p>
        }
    </div>
</div>

@code {
    private string password = "";
    private string errorMessage = "";
    private bool isLoading = false;

    private async Task HandleKeyPress(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            await HandleLogin();
        }
    }

    private async Task HandleLogin()
    {
        if (string.IsNullOrWhiteSpace(password))
        {
            errorMessage = "è«‹è¼¸å…¥æš—è™Ÿï¼";
            return;
        }

        isLoading = true;
        errorMessage = "";

        try
        {
            var success = await AuthService.LoginAsync(password);
            if (!success)
            {
                errorMessage = "æš—è™Ÿä¸å°å–”ï¼Œå†æƒ³ä¸€æ¬¡ï¼";
            }
        }
        catch
        {
            errorMessage = "é€£ç·šéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦";
        }
        finally
        {
            isLoading = false;
        }
    }
}

<style>
    .error-message {
        color: #f44336;
        margin-top: 1rem;
        font-size: 0.9rem;
    }
</style>
